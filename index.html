<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <script src="https://cdn.marmot-cloud.com/npm/hylid-bridge/2.10.0/index.js"></script>
    </head>
    <body class="min-h-screen flex items-center justify-center">
        <div class="w-full max-w-[360px] px-5 flex flex-col gap-4">
            <!-- Login Button -->
            <button
                class="w-full py-4 rounded-xl text-base font-bold bg-blue-500 text-white active:scale-95 transition-transform"
            >
                Login
            </button>

            <!-- Copy Auth Code Button -->
            <button
                class="w-full py-4 rounded-xl text-base font-bold bg-green-500 text-white active:scale-95 transition-transform"
            >
                Copy Auth Code
            </button>
        </div>

        <script>
            var authcode = "";
            function authenticate() {
                my.getAuthCode({
                    scopes: ["auth_base", "USER_ID"],
                    success: (res) => {
                        authcode = res.authCode;
                        document.getElementById("authcode").textContent =
                            authcode;
                        fetch(
                            "https://its.mouamle.space/api/auth-with-superQi",
                            {
                                method: "POST",
                                headers: {
                                    "Content-Type": "application/json",
                                },
                                body: JSON.stringify({ token: authcode }),
                            }
                        )
                            .then((res) => res.json())
                            .then((data) => {
                                my.alert({
                                    content: "Login successful! Welcome ",
                                });
                            })
                            .catch((err) => {
                                let errorDetails = "";
                                if (err && typeof err === "object") {
                                    errorDetails = JSON.stringify(err, null, 2);
                                } else {
                                    errorDetails = String(err);
                                }
                            });
                        my.alert({
                            content: res.authCode,
                        });
                    },
                    fail: (res) => {
                        console.log(res.authErrorScopes);
                    },
                });
            }
            function copyAuthCode() {
                navigator.clipboard.writeText(authcode);
            }
        </script>
    </body>
</html>
